<!DOCTYPE HTML>
<html lang="en-us">

<head>
    <meta charset="utf-8">
    <title>Loan</title>
    <script>
        /* Input: 5 text fields principal, annualRate, years, periodsPerYear,and numberOfPaymentsPaidToDate.
         * Processing: payment function calculates p= (ar)/1-(1+r)^-n and b=a(1+r)^d -(p991+r)^d-1)/r
         * Output: two different divs from the two different functions.
         */
        
		function doPayment() {
			let principal = parseFloat(document.getElementById('principal').value);
			let annualRate = parseFloat(document.getElementById('annualRate').value);
			let years = parseFloat(document.getElementById('years').value);
			let periodsPerYear = parseFloat(document.getElementById('periodsPerYear').value);
			
			let payment = "";

            payment = computePayment(principal, annualRate, years, periodsPerYear).toFixed(2);

            document.getElementById('outputPayment').innerHTML = "$ " + payment;
		}
		
		function doBalance() {
			let principal = parseFloat(document.getElementById('principal').value);
			let annualRate = parseFloat(document.getElementById('annualRate').value);
			let years = parseFloat(document.getElementById('years').value);
			let periodsPerYear = parseFloat(document.getElementById('periodsPerYear').value);
			let numberOfPaymentPaidToDate = parseFloat(document.getElementById('numberOfPaymentPaidToDate').value);
			
			let balance = "";

            balance = computeBalance(principal, annualRate, years, periodsPerYear, numberOfPaymentPaidToDate).toFixed(2);

            document.getElementById('outputBalance').innerHTML = "$ " + balance;
		}
		
		function computePayment(principal, annualRate, years, periodsPerYear) {
			
			let a = principal;
			let r = annualRate / periodsPerYear;
			let n = years * periodsPerYear;
			
			return (a * r) / (1 - (1 + r) ** -n)
		}
		
		function computeBalance(principal, annualRate, years, periodsPerYear, numberOfPaymentPaidToDate) {
			
			let a = principal;
			let r = annualRate / periodsPerYear;
			let d = numberOfPaymentPaidToDate;
			let p = "";
			p =	computePayment(principal, annualRate, years, periodsPerYear);
			
			let part1 = a * (1 + r) ** d;
			let part2 = p * ((1+r) ** d -1);
				
			return part1 - part2 / r;
			
		
		}
			
		
    </script>
</head>

<body>
    <h2>Loan Calculator</h2>
    <p>Amount Borrowed (principal) <input type="text" id="principal"></p>
	<p>Annual Rate (example: 0.08) <input type="text" id="annualRate"></p>
	<p>Number of Years <input type="text" id="years"></p>
	<p>Payments per Year <input type="text" id="periodsPerYear"></p>
    <button type="button" onclick="doPayment()">Compute Payments</button>
    <div id="outputPayment"></div>
	<p>Number of Payments paid to Date <input type="text" id="numberOfPaymentPaidToDate"></p>
	<button type="button" onclick="doBalance()">Compute Payoff Amount</button>
	<div id="outputBalance"></div>
</body>

</html>